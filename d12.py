import re
from collections import defaultdict

#s = '#..#.#..##......###...###'
s = '#.#.#...#..##..###.##.#...#.##.#....#..#.#....##.#.##...###.#...#######.....##.###.####.#....#.#..##'

rules = [
    '...## => #',
    '..#.. => #',
    '.#... => #',
    '.#.#. => #',
    '.#.## => #',
    '.##.. => #',
    '.#### => #',
    '#.#.# => #',
    '#.### => #',
    '##.#. => #',
    '##.## => #',
    '###.. => #',
    '###.# => #',
    '####. => #'
]

rules = """#...# => #
....# => .
##..# => #
.#.## => #
##.## => .
###.# => #
..... => .
...#. => .
.#.#. => #
#.##. => #
..#.# => #
.#... => #
#.#.. => .
##.#. => .
.##.. => #
#..#. => .
.###. => .
..#.. => .
#.### => .
..##. => .
.#..# => #
.##.# => .
.#### => .
...## => #
#.#.# => #
..### => .
#..## => .
####. => #
##### => .
###.. => #
##... => #
#.... => ."""

R = defaultdict(lambda: '.')

for r in rules.split('\n'):
    m = re.match('(.{5}) => (.)', r)
    R[m.group(1)] = m.group(2)

# guess1 = 2950000000001598
#          2950000001598

left_pot = 0
N = 200
last_total_pot = 0
for i in range(1, N + 1):
    left_pot -= 1
    s = f'...{s}'
    t = []
    total_pot = 0
    for pot, j in enumerate(range(len(s)), left_pot):
        r = f'{s[j:j+5]:.<5}'
        t.append(R[r])
        if R[r] == '#':
            total_pot += pot
    s = ''.join(t)
    #if i % 100 == 0:
    print(i, total_pot, total_pot - last_total_pot)
    last_total_pot = total_pot
